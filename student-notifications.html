<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="favicon.png">    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications - MindWave</title>
    <link rel="stylesheet" href="3d-depth-design.css">
    <style>
        .notifications-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 32px;
        }

        .notification-card {
            background: var(--card-dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .notification-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(135deg, var(--cyan-bright), var(--purple-bright));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .notification-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
            border-color: var(--cyan-bright);
        }

        .notification-card:hover::before {
            opacity: 1;
        }

        .notification-card.unread {
            background: rgba(15, 98, 254, 0.05);
            border-color: rgba(15, 98, 254, 0.3);
        }

        .notification-card.unread::before {
            opacity: 1;
        }

        .notification-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: rgba(255, 255, 255, 0.05);
        }

        .notification-title {
            flex: 1;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-white);
            margin: 0;
        }

        .notification-time {
            font-size: 12px;
            color: var(--text-gray);
        }

        .notification-message {
            color: var(--text-gray);
            line-height: 1.6;
            margin: 0;
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-gray);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        .filter-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
        }

        .filter-tab {
            flex: 1;
            padding: 10px 16px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--text-gray);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-tab:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-white);
        }

        .filter-tab.active {
            background: linear-gradient(135deg, var(--cyan-bright), var(--purple-bright));
            color: white;
        }

        .mark-all-read {
            padding: 10px 20px;
            background: rgba(52, 199, 89, 0.1);
            border: 1px solid rgba(52, 199, 89, 0.3);
            border-radius: 999px;
            color: #34c759;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mark-all-read:hover {
            background: rgba(52, 199, 89, 0.2);
            transform: translateY(-2px);
        }
    </style>
</head>

<body data-theme="dark">
    <div class="app-shell">
        <header class="topbar">
            <div class="topbar-brand">
                <span>üåä</span>
                <span>MindwaveIo</span>
            </div>
        </header>

        <main style="padding: 32px 48px;">
            <div class="main-header" style="margin-bottom: 32px;">
                <div>
                    <a href="homepage.html" class="ghost-btn" style="display: inline-block; margin-bottom: 16px;">‚Üê Back
                        to Dashboard</a>
                    <h1 style="margin: 0 0 8px;">üîî Notifications</h1>
                    <p style="color: var(--text-gray); margin: 0;">Stay updated with announcements, new games, and
                        important updates</p>
                </div>
                <button class="mark-all-read" id="markAllReadBtn">‚úì Mark All as Read</button>
            </div>

            <div class="notifications-container">
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">All</button>
                    <button class="filter-tab" data-filter="unread">Unread</button>
                    <button class="filter-tab" data-filter="announcements">Announcements</button>
                    <button class="filter-tab" data-filter="games">Games</button>
                </div>

                <div id="notificationsList">
                    <div class="empty-state">
                        <div class="empty-state-icon">üîî</div>
                        <h3>No notifications yet</h3>
                        <p>You're all caught up! New notifications will appear here.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let allNotifications = [];
        let currentFilter = 'all';

        async function fetchNotifications() {
            try {
                const res = await fetch(`${API_BASE}/api/notifications`);
                const data = await res.json();
                if (data.ok) {
                    allNotifications = data.notifications || [];
                    renderNotifications();
                }
            } catch (error) {
                console.error('Failed to fetch notifications:', error);
            }
        }

        function renderNotifications() {
            const container = document.getElementById('notificationsList');

            let filtered = allNotifications;
            if (currentFilter === 'unread') {
                filtered = allNotifications.filter(n => !n.read);
            } else if (currentFilter === 'announcements') {
                filtered = allNotifications.filter(n => n.title.includes('Announcement'));
            } else if (currentFilter === 'games') {
                filtered = allNotifications.filter(n => n.title.includes('Game'));
            }

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîî</div>
                        <h3>No ${currentFilter === 'all' ? '' : currentFilter} notifications</h3>
                        <p>You're all caught up!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(n => {
                const icon = n.title.includes('Game') ? 'üéÆ' :
                    n.title.includes('Announcement') ? 'üì¢' :
                        n.title.includes('Update') ? 'üìù' : 'üîî';

                const time = new Date(n.createdAt);
                const timeStr = time.toLocaleString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: '2-digit'
                });

                return `
                    <div class="notification-card ${n.read ? '' : 'unread'}">
                        <div class="notification-header">
                            <div class="notification-icon">${icon}</div>
                            <h3 class="notification-title">${n.title}</h3>
                            <span class="notification-time">${timeStr}</span>
                        </div>
                        <p class="notification-message">${n.message}</p>
                    </div>
                `;
            }).join('');

            // Removed click handlers - notifications are now display-only
        }

        // Filter tabs
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentFilter = tab.dataset.filter;
                renderNotifications();
            });
        });

        // Mark all as read
        document.getElementById('markAllReadBtn').addEventListener('click', async () => {
            try {
                // Mark all as read in backend (you'll need to implement this endpoint)
                await fetch(`${API_BASE}/api/notifications/mark-all-read`, {
                    method: 'POST',
                    credentials: 'include'
                });

                // Update local state
                allNotifications = allNotifications.map(n => ({ ...n, read: true }));
                renderNotifications();
            } catch (error) {
                console.error('Failed to mark all as read:', error);
            }
        });

        // Initial load
        fetchNotifications();
    </script></body>

</html>